# Transor 影院模式扩展

Transor 是一个提供YouTube影院模式体验的Chrome扩展，专注于优化双语字幕显示体验。

## 主要功能

1. **影院模式**：将YouTube视频转换为全屏影院模式体验
2. **双语字幕**：支持英文原文和中文翻译的双语字幕显示
3. **字幕同步**：实时跟踪视频播放进度，精准匹配字幕
4. **字幕控制**：支持手动前进/后退/隐藏字幕

## 核心算法

### 字幕匹配算法

影院模式使用优化的二分查找算法来匹配当前视频时间最接近的字幕：

1. **直接匹配**：
   - 如果当前时间在某个字幕的时间范围内（start到end），直接返回该字幕
   
2. **近似匹配**：
   - 如果没有精确匹配，在当前位置附近查找最接近的字幕
   - 计算当前时间与字幕开始/结束时间的最小距离
   - 如果最小距离小于阈值（0.8秒），返回该字幕

3. **边界处理**：
   - 如果当前时间小于第一个字幕开始时间，不显示字幕
   - 如果当前时间大于最后一个字幕结束时间，不显示字幕

### 视频时间追踪

为了准确计算视频当前时间，特别是考虑到暂停和播放速度变化：

1. **直接获取**：通过YouTube iframe API直接获取当前播放时间
2. **状态补偿**：
   - 记录上一次获取的时间和获取时刻
   - 在暂停状态下，返回上一次记录的时间
   - 在播放状态下，根据经过时间和播放速度计算预估时间
3. **实时更新**：每100毫秒更新一次，确保字幕跟随视频实时变化

## 优化策略

1. **局部搜索**：只在当前索引附近查找最接近的字幕，而不是扫描全部字幕
2. **时间阈值**：设置合理的时间阈值，避免频繁切换字幕
3. **详细日志**：记录字幕匹配和显示过程，便于调试和优化
4. **异常处理**：完善的错误处理，确保字幕显示的稳定性

## 使用方法

在YouTube视频页面点击Transor扩展图标，选择"影院模式"即可启动。影院模式下可以通过底部控制栏控制字幕显示和导航。

## 技术栈

- Vue 2.0
- Element UI
- Chrome Extension API
- ES6+

## 项目结构

```
transor-extension/
├── public/                 # 静态资源和Chrome扩展文件
│   ├── manifest.json       # 扩展清单文件
│   ├── background.js       # 背景脚本
│   ├── content-script.js   # 内容脚本
│   ├── popup.html          # 弹出窗口HTML
│   └── icons/              # 扩展图标
├── src/                    # Vue项目源代码
│   ├── components/         # Vue组件
│   ├── api/                # API服务
│   ├── utils/              # 工具函数
│   ├── store/              # Vuex存储
│   ├── App.vue             # 主应用组件
│   └── main.js             # 入口文件
└── package.json            # 项目依赖
```

## 安装和使用

### 开发环境

1. 克隆项目
```bash
git clone https://github.com/yourusername/transor-extension.git
cd transor-extension
```

2. 安装依赖
```bash
npm install
```

3. 启动开发服务器
```bash
npm run serve
```

4. 构建扩展
```bash
npm run build
```

5. 加载扩展
   - 打开Chrome浏览器，进入扩展管理页面（chrome://extensions/）
   - 开启"开发者模式"
   - 点击"加载已解压的扩展程序"
   - 选择项目中的`dist`目录

### 使用指南

1. 点击Chrome工具栏上的Transor图标打开设置面板
2. 选择目标语言、源语言、翻译引擎和翻译样式
3. 开启翻译开关，当前页面将自动进行翻译
4. 根据需要进行高级设置，如排除特定标签或类名

## 注意事项

- 本扩展使用非官方的Google翻译API进行演示，实际使用中可能需要替换为官方API
- 对于DeepL和百度翻译，需要注册获取API密钥才能正常使用

## 许可证

MIT

## 贡献

欢迎通过Issues或Pull Requests贡献代码和意见。

---

Transor - 让全球网页无障碍阅读 